!function($){"use strict";const page=WDS.page_name;function audio(){if("dashboard/invitation/edit"==page&&$("#form--audio").length){if($("#form--audio #default").length&&$("#form--audio #default").on("click",(function(){$("#form--audio").attr("data-type","default"),$("#form--audio .data-default").show(),$("#form--audio .data-youtube").hide(),$("#form--audio .data-custom").hide()})),$("#form--audio #youtube").length&&$("#form--audio #youtube").on("click",(function(){$("#form--audio").attr("data-type","youtube"),$("#form--audio .data-youtube").show(),$("#form--audio .data-default").hide(),$("#form--audio .data-custom").hide()})),$("#form--audio #custom").length){$("#form--audio #custom").on("click",(function(){$("#form--audio").attr("data-type","custom"),$("#form--audio .data-custom").show(),$("#form--audio .data-default").hide(),$("#form--audio .data-youtube").hide()}));var id="#dropzone_mp3",dropzone=document.querySelector(id),maxSize=WDS.inv.max_upload_mp3/1e3,previewNode=dropzone.querySelector(".dropzone-item");previewNode.id="";var previewTemplate=previewNode.parentNode.innerHTML;previewNode.parentNode.removeChild(previewNode);var myDropzone=new Dropzone(id,{url:"https://domain.com",autoProcessQueue:!1,maxFiles:1,maxFilesize:maxSize,previewTemplate:previewTemplate,previewsContainer:id+" .dropzone-items",clickable:id+" .dropzone-select",acceptedFiles:"audio/*"});myDropzone.on("addedfile",(function(file){const dropzoneItems=dropzone.querySelectorAll(".dropzone-item");dropzoneItems.forEach(dropzoneItem=>{dropzoneItem.style.display=""})}))}var selectElement=$("#form--audio select"),audioSrc=$("#preview_audio")[0];selectElement.on("change",(function(){var audioLink=selectElement.find(":selected").data("audio");audioSrc.setAttribute("src",audioLink)}));var form=document.querySelector("#form--audio"),btn=document.querySelector("#form--audio--submit");btn.addEventListener("click",(function(e){e.preventDefault(),disableButton(btn);var formData=new FormData(form),post_id=form.getAttribute("data-id"),dataType=form.getAttribute("data-type"),selected=form.querySelector("select").value;if(formData.append("post_id",post_id),formData.append("audio_type",dataType),formData.append("selected",selected),"custom"==dataType){var files=myDropzone.getAcceptedFiles();0!=files.length&&(myDropzone.enqueueFiles(myDropzone.getFilesWithStatus(Dropzone.ADDED)),formData.append("custom",files[0]))}run_ajax("invitation_edit_audio",formData,(function(response){const message=response.data&&response.data.message?response.data.message:response.data;response.success?run_ajax_success(message).then(result=>{if(result.isConfirmed){var audio=$("#preview_audio")[0];audio&&audio.pause();var dropdownParent=$('select[id="audio"]').attr("data-dropdown-parent");$(dropdownParent).modal("hide"),"custom"==dataType&&window.location.reload()}}):run_ajax_error(message),resetButton(btn)}))}))}}function theme(){if("dashboard/invitation/edit"==page&&$("#form--theme").length){var selectElement=$("#form--theme #invitation-theme"),previewLink=$("#theme-preview a")[0],category;if($("#form--theme #select-category").length)$("#form--theme #select-category").change((function(){var selected=$(this).val(),formData=new FormData(form),post_id=form.getAttribute("data-id");formData.append("category",selected),formData.append("post_id",post_id),run_ajax("invitation_terms_callback",formData,(function(response){$("#form--theme #taxonomy").val(response.data.taxonomy),$("#form--theme #invitation-theme").html(response.data.template),$("#theme-preview img").attr("src",response.data.preview_thumbnail),previewLink.setAttribute("href",response.data.preview_permalink)}))}));selectElement.on("change",(function(){var permalink=selectElement.find(":selected").data("permalink"),thumbnail=selectElement.find(":selected").data("thumbnail");previewLink.setAttribute("href",permalink),$("#theme-preview img").attr("src",thumbnail)}));var form=document.querySelector("#form--theme"),btn=document.querySelector("#form--theme--submit");btn.addEventListener("click",(function(e){e.preventDefault(),disableButton(btn);var formData=new FormData(form),post_id=form.getAttribute("data-id"),category=$("#form--theme #select-category").length?form.querySelector("#form--theme #select-category").value:"",taxonomy=form.querySelector("#form--theme #taxonomy").value,theme=form.querySelector("#form--theme #invitation-theme").value;formData.append("post_id",post_id),formData.append("category",category),formData.append("taxonomy",taxonomy),formData.append("theme",theme),run_ajax("invitation_edit_theme",formData,(function(response){const message=response.data&&response.data.message?response.data.message:response.data;response.success?run_ajax_success(message).then(result=>{if(result.isConfirmed){var dropdownParent=selectElement.attr("data-dropdown-parent");$(dropdownParent).modal("hide"),"yes"==WDS.inv.theme_reload&&window.location.reload()}}):run_ajax_error(message),resetButton(btn)}))}))}}KTUtil.onDOMContentLoaded((function(){audio(),theme()}))}(jQuery);