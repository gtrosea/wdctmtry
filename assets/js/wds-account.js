!function($){"use strict";const page=WDS.page_name;function settings_page(){if("account/settings"!=page)return;const redirectUrl=WDS.url.settings;var profileForm=document.getElementById("profile_form"),profileBtn=document.getElementById("profile_submit"),profileFields={fullname:{validators:{notEmpty:{message:WDS.text.error.name_required}}},phone:{validators:{notEmpty:{message:WDS.text.error.phone_required}}}},validatorProfile=initValidation(profileForm,profileFields);if(profileBtn.addEventListener("click",(function(e){e.preventDefault(),validatorProfile.validate().then((function(status){if("Valid"==status){var formData=new FormData(profileForm);disableButton(profileBtn),run_ajax("profile_form",formData,(function(response){const message=response.data&&response.data.message?response.data.message:response.data;response.success?run_ajax_success(message).then(result=>{result.isConfirmed&&(location.href=redirectUrl)}):run_ajax_error(message),resetButton(profileBtn)}))}else run_ajax_error(WDS.text.error.input)}))})),$("#reseller_form").length){var resellerForm=document.getElementById("reseller_form"),resellerBtn=document.getElementById("reseller_submit"),resellerFields,validatorReseller=initValidation(resellerForm,{logo:{validators:{file:{maxSize:524288,message:"The file size is too large. Maximum size is 512KB"}}}});resellerBtn.addEventListener("click",(function(e){e.preventDefault(),validatorReseller.validate().then((function(status){if("Valid"==status){var formData=new FormData(resellerForm);disableButton(resellerBtn),run_ajax("reseller_form",formData,(function(response){const message=response.data&&response.data.message?response.data.message:response.data;response.success?run_ajax_success(message).then(result=>{result.isConfirmed&&(location.href=redirectUrl)}):run_ajax_error(message),resetButton(resellerBtn)}))}else run_ajax_error(WDS.text.error.input)}))}))}var changeEmailButton=document.getElementById("change_email_button"),changeEmailCancel=document.getElementById("change_email_cancel"),changeEmailData=document.getElementById("change_email_data"),changeEmailEdit=document.getElementById("change_email_edit"),changeEmailForm=document.getElementById("change_email_form"),changeEmailSubmit=document.getElementById("change_email_submit");function toggleChangeEmail(){changeEmailButton.classList.toggle("d-none"),changeEmailData.classList.toggle("d-none"),changeEmailEdit.classList.toggle("d-none")}changeEmailButton.querySelector("button").addEventListener("click",(function(){toggleChangeEmail()})),changeEmailCancel.addEventListener("click",(function(){toggleChangeEmail()}));var emailFields={emailaddress:{validators:{notEmpty:{message:WDS.text.error.email_required},emailAddress:{message:WDS.text.error.email_invalid}}},confirmemailpassword:{validators:{notEmpty:{message:WDS.text.error.password_required}}}},validatorEmail=initValidation(changeEmailForm,emailFields);changeEmailSubmit.addEventListener("click",(function(e){e.preventDefault(),validatorEmail.validate().then((function(status){if("Valid"==status){var formData=new FormData(changeEmailForm);run_ajax("change_email_form",formData,(function(response){const message=response.data&&response.data.message?response.data.message:response.data;response.success?run_ajax_success(message).then(result=>{result.isConfirmed&&(location.href=redirectUrl)}):run_ajax_error(message)}))}else run_ajax_error(WDS.text.error.input)}))}));var changePassButton=document.getElementById("change_password_button"),changePassCancel=document.getElementById("change_password_cancel"),changePassData=document.getElementById("change_password_data"),changePassEdit=document.getElementById("change_password_edit"),changePassForm=document.getElementById("change_password_form"),changePassSubmit=document.getElementById("change_password_submit");function toggleChangePassword(){changePassButton.classList.toggle("d-none"),changePassData.classList.toggle("d-none"),changePassEdit.classList.toggle("d-none")}changePassButton.querySelector("button").addEventListener("click",(function(){toggleChangePassword()})),changePassCancel.addEventListener("click",(function(){toggleChangePassword()}));var passFields={password:{validators:{notEmpty:{message:WDS.text.error.password_current_required}}},pass1:{validators:{notEmpty:{message:WDS.text.error.password_new_required}}},pass2:{validators:{notEmpty:{message:WDS.text.error.password_new_confirm_required},identical:{compare:function(){return changePassForm.querySelector('[name="pass1"]').value},message:WDS.text.error.password_confirm_error}}}},validatorPassword=initValidation(changePassForm,passFields);changePassSubmit.addEventListener("click",(function(e){e.preventDefault(),validatorPassword.validate().then((function(status){if("Valid"==status){var formData=new FormData(changePassForm);run_ajax("change_password_form",formData,(function(response){const message=response.data&&response.data.message?response.data.message:response.data;response.success?run_ajax_success(message).then(result=>{result.isConfirmed&&(location.href=redirectUrl)}):run_ajax_error(message)}))}else run_ajax_error(WDS.text.error.input)}))}))}function referrals_page(){if("account/referrals"==page){copy_clipboard(document.querySelector("#general_link_btn"),document.querySelector("#general_link_input")),copy_clipboard(document.querySelector("#salespage_link_btn"),document.querySelector("#salespage_link_input")),copy_clipboard(document.querySelector("#checkout_link_btn"),document.querySelector("#checkout_link_input"));var form=document.querySelector("#generate_form"),btn=document.querySelector("#generate_submit"),element=document.querySelector("#result_generate_link");btn.addEventListener("click",(function(e){var product;if(e.preventDefault(),$("#product").val()){disableButton(btn),element.classList.add("d-none");var formData=new FormData(form);run_ajax("generate_referral_link",formData,(function(response){const message=response.data&&response.data.message?response.data.message:response.data;response.success?(element.classList.remove("d-none"),$("#salespage_link_input").val(response.data.salespage_url),$("#checkout_link_input").val(response.data.checkout_url)):run_ajax_error(message),resetButton(btn)}))}else run_ajax_error(WDS.text.error.generate)}));var formWD=document.querySelector("#wd_form"),btnWD=document.querySelector("#wd_submit"),modalWD=new bootstrap.Modal(document.querySelector("#wd-form-modal")),fields={method:{validators:{notEmpty:{message:WDS.text.error.payment_method}}},account:{validators:{notEmpty:{message:WDS.text.error.payment_method_account}}}},validatorWD=initValidation(formWD,fields);btnWD.addEventListener("click",(function(e){e.preventDefault(),validatorWD.validate().then((function(status){if("Valid"==status){disableButton(btnWD);var formData=new FormData(formWD);run_ajax("save_widthdraw_method",formData,(function(response){const message=response.data&&response.data.message?response.data.message:response.data;response.success?run_ajax_success(message).then(result=>{result.isConfirmed&&modalWD.hide()}):run_ajax_error(message),resetButton(btnWD)}))}else run_ajax_error(WDS.text.error.input)}))})),document.querySelectorAll(".coupon_submit").forEach((function(saveCoupon){saveCoupon.addEventListener("click",(function(e){e.preventDefault();var form=this.closest(".coupon_form"),formId=form.getAttribute("data-form-id"),formData=new FormData(form);formData.append("coupon_id",formId),run_ajax("save_coupon",formData,(function(response){const message=response.data&&response.data.message?response.data.message:response.data;response.success?run_ajax_success(message):run_ajax_error(message)}))}))})),document.querySelectorAll(".coupon_delete").forEach((function(deleteCoupon){deleteCoupon.addEventListener("click",(function(e){e.preventDefault();var form=this.closest(".coupon_form"),formId=form.getAttribute("data-form-id"),formData=new FormData(form);formData.append("coupon_id",formId),run_ajax("delete_coupon",formData,(function(response){const message=response.data&&response.data.message?response.data.message:response.data;response.success?run_ajax_success(message):run_ajax_error(message)}))}))}))}}KTUtil.onDOMContentLoaded((function(){settings_page(),referrals_page()}))}(jQuery);