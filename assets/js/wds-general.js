!function($){"use strict";const page=WDS.page_name;function wds_trx_ajax(name,context,callback){$.ajax({type:"POST",dataType:"html",url:WDS.ajax_url,data:{__nonce:WDS.ajax_nonce,action:"run_wds",name:name,context:context},success:function(response){"function"==typeof callback&&callback(response)},error:function(xhr){console.error("An error occurred: "+xhr.statusText)}})}function updateSummary(name,name2,context,btn){var $placeholder=$("#sum-placeholder"),$summary=$("#sum-data"),$refered=$("#wds-referred");$refered.hide(),$summary.hide(),$placeholder.show(),disableButton(btn),wds_trx_ajax(name,context,(function(data){$placeholder.hide(),$summary.html(data),$summary.show(),resetButton(btn)})),wds_trx_ajax(name2,context,(function(data){"noreff"!=data&&($refered.html(data),$refered.show())}))}function checkout_page(){if("checkout"!=page)return;const isLogin="yes"==WDS.is_login;var form=document.querySelector("#checkout_form"),btn=document.querySelector("#checkout_btn"),fields={fullname:{validators:{notEmpty:{message:WDS.text.error.name_required}}},email:{validators:{regexp:{regexp:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:WDS.text.error.email_invalid},notEmpty:{message:WDS.text.error.email_required},remote:{url:WDS.ajax_url,method:"POST",data:{name:"checkout_check_email",action:"run_wds",__nonce:WDS.ajax_nonce,email:function(){return form.querySelector('[name="email"]').value}},delay:500,onSuccess:function(response){if(response.message)return{valid:!1,message:response.message}}}}},phone:{validators:{notEmpty:{message:WDS.text.error.phone_required},remote:{url:WDS.ajax_url,method:"POST",data:{name:"checkout_check_phone",action:"run_wds",__nonce:WDS.ajax_nonce,phone:function(){return form.querySelector('[name="phone"]').value}},delay:500,onSuccess:function(response){if(response.message)return{valid:!1,message:response.message}}}}},password:{validators:{notEmpty:{message:WDS.text.error.password_required}}}},validator=initValidation(form,fields),chekoutType=form.getAttribute("data-type");function beforeCheckout(){var agree=form.querySelector('[name="agree_to_terms"]');"active"==WDS.sk?agree&&agree.checked?(disableButton(btn),processCheckout()):(run_ajax_error(WDS.text.error.sk),agree.closest(".border.rounded-10").classList.add("border-danger")):(disableButton(btn),processCheckout())}function processCheckout(){var formData=new FormData(form);formData.append("context",chekoutType),run_ajax("checkout_process_data",formData,(function(response){const message=response.data&&response.data.message?response.data.message:response.data;response.success?location.href=response.data:(run_ajax_error(message),resetButton(btn))}))}btn.addEventListener("click",(function(e){e.preventDefault(),isLogin?beforeCheckout():validator.validate().then((function(status){"Valid"==status?beforeCheckout():run_ajax_error(WDS.text.error.input)}))})),"digital"!=chekoutType&&document.querySelectorAll(".addon .form-check-input").forEach((function(addon){addon.addEventListener("change",(function(){var parent=this.closest("div.form-check"),dataId=parent.getAttribute("data-id"),dataTitle=parent.getAttribute("data-title"),dataPrice=parent.getAttribute("data-price"),dataAddon=this.checked?"active":"inactive",formData=new FormData;formData.append("addon",dataAddon),formData.append("addon_id",dataId),formData.append("addon_title",dataTitle),formData.append("addon_price",dataPrice),run_ajax("checkout_change_addon",formData,(function(response){const message=response.data&&response.data.message?response.data.message:response.data;response.success&&run_ajax_success(message),updateSummary("checkout_update_summary","checkout_update_refered",chekoutType,btn)}))}))})),document.querySelectorAll('input[name="gateway"]').forEach((function(gateway){gateway.addEventListener("change",(function(){var selectedGateway=document.querySelector('input[name="gateway"]:checked').value,gatewayButtons;document.querySelectorAll(".btn-active").forEach((function(button){button.classList.remove("btn-outline-primary")})),this.closest(".btn-active").classList.add("btn-outline-primary");var formData=new FormData;formData.append("gateway",selectedGateway),formData.append("context",chekoutType),run_ajax("checkout_change_gateway",formData,(function(response){updateSummary("checkout_update_summary","checkout_update_refered",chekoutType,btn)}))}))}));var coupon=document.querySelector("#apply_coupon");coupon&&coupon.addEventListener("click",(function(){disableButton(coupon);var couponInput=form.querySelector('[name="coupon"]').value,formData=new FormData;formData.append("coupon",couponInput),formData.append("context",chekoutType),run_ajax("checkout_apply_coupon",formData,(function(response){const message=response.data&&response.data.message?response.data.message:response.data;response.success?run_ajax_success(message):run_ajax_error(message),resetButton(coupon),updateSummary("checkout_update_summary","checkout_update_refered",chekoutType,btn)}))})),updateSummary("checkout_update_summary","checkout_update_refered",chekoutType,btn)}function renew_page(){if("renew"==page){var form=document.querySelector("#renew_form"),btn=document.querySelector("#renew_btn");btn.addEventListener("click",(function(e){e.preventDefault(),disableButton(btn);var formData=new FormData(form);run_ajax("renew_process_data",formData,(function(response){const message=response.data&&response.data.message?response.data.message:response.data;response.success?location.href=response.data:(run_ajax_error(message),resetButton(btn))}))})),document.querySelectorAll('input[name="gateway"]').forEach((function(gateway){gateway.addEventListener("change",(function(){var selectedGateway=document.querySelector('input[name="gateway"]:checked').value,gatewayButtons;document.querySelectorAll(".btn-active").forEach((function(button){button.classList.remove("btn-outline-primary")})),this.closest(".btn-active").classList.add("btn-outline-primary");var formData=new FormData;formData.append("gateway",selectedGateway),run_ajax("renew_change_gateway",formData,(function(response){updateSummary("renew_update_summary","renew_update_refered","renew",btn)}))}))})),updateSummary("renew_update_summary","renew_update_refered","renew",btn)}}KTUtil.onDOMContentLoaded((function(){checkout_page(),renew_page()}))}(jQuery);